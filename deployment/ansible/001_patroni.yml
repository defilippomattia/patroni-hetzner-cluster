- name: Install Python, pip, and Patroni
  hosts: all
  become: true
  tasks:
    - name: Download get-pip.py
      get_url:
        url: https://bootstrap.pypa.io/get-pip.py
        dest: /tmp/get-pip.py

    - name: Install pip using get-pip.py
      command: python3 /tmp/get-pip.py

    - name: Install Patroni with dependencies (psycopg3, etcd3)
      pip:
        name: patroni[psycopg3,etcd3]
